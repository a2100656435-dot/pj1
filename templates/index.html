<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>文件扫描</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 30px; }
      textarea { width: 100%; height: 400px; margin-top: 10px; }
      #result { white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; margin-top: 10px; }
    </style>
  </head>
  <body>
    <h2>文件扫描</h2>
    <form id="uploadForm">
      <input type="file" name="file" required>
      <button type="submit">上传并提取文字</button>
    </form>

    <div id="result"></div>

    <script>
      const form = document.getElementById('uploadForm');
      const resultDiv = document.getElementById('result');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        resultDiv.textContent = "扫描中，请稍候...";

        const fileInput = form.querySelector('input[type=file]');
        const formData = new FormData();
        formData.append('file', fileInput.files[0]);

        try {
          const res = await fetch('/upload', {
            method: 'POST',
            body: formData
          });
          const data = await res.json();
          if(data.status === "success"){
            resultDiv.textContent = data.text;
          } else {
            resultDiv.textContent = "错误：" + data.message;
          }
        } catch(err){
          resultDiv.textContent = "网络错误：" + err;
        }
      });
    </script>
  </body>
</html>
